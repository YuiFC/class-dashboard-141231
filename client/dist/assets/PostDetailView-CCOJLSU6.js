import{_ as P,k as R,r as _,i as $,c as r,a as c,h as x,b as o,e,w as u,t,F as j,j as S,s as b,E as p,d as T,o as a,f as g}from"./index-vBUVIBNg.js";const U={class:"detail-container"},q={key:0,style:{padding:"20px"}},G={key:1,class:"content-wrapper"},H={class:"post-header"},J={class:"title"},K={class:"meta-info"},O={class:"time"},Q={class:"post-body"},W={class:"comments-section"},X={key:0,class:"comment-list"},Y={class:"comment-avatar"},Z={class:"comment-content"},ee={class:"comment-author"},te={class:"name"},se={class:"floor"},oe={class:"text"},ae={class:"comment-time"},ne={class:"comment-input-area"},ce={style:{"margin-top":"10px","text-align":"right"}},le={__name:"PostDetailView",setup(re){const V=R(),C=T(),y=V.params.id,h=_(!0),v=_(!1),l=_(null),m=_([]),i=_(""),f=async()=>{h.value=!0;try{const s=await b.get(`/posts/${y}`);l.value=s.post,m.value=s.comments}catch{p.error("获取帖子详情失败")}finally{h.value=!1}},B=async()=>{if(!i.value.trim()){p.warning("评论内容不能为空");return}v.value=!0;try{await b.post(`/posts/${y}/comments`,{content:i.value}),p.success("评论成功"),i.value="",f()}catch(s){p.error(s.message||"评论失败")}finally{v.value=!1}},D=()=>{C.back()},k=s=>s?new Date(s).toLocaleString("zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return $(()=>{f()}),(s,d)=>{const z=o("el-page-header"),N=o("el-skeleton"),A=o("el-tag"),E=o("el-card"),F=o("el-avatar"),w=o("el-empty"),I=o("el-input"),L=o("el-button");return a(),r("div",U,[c(z,{onBack:D,content:"帖子详情",class:"page-header"}),h.value?(a(),r("div",q,[c(N,{rows:5,animated:""})])):l.value?(a(),r("div",G,[c(E,{class:"post-card",shadow:"never"},{header:u(()=>[e("div",H,[e("h1",J,t(l.value.title),1),e("div",K,[c(A,{size:"small"},{default:u(()=>[g(t(l.value.author?.name||"匿名"),1)]),_:1}),e("span",O,t(k(l.value.createdAt)),1)])])]),default:u(()=>[e("div",Q,t(l.value.content),1)]),_:1}),e("div",W,[e("h3",null,"评论 ("+t(m.value.length)+")",1),m.value.length>0?(a(),r("div",X,[(a(!0),r(j,null,S(m.value,(n,M)=>(a(),r("div",{key:n._id,class:"comment-item"},[e("div",Y,[c(F,{size:32,style:{"background-color":"#67c23a"}},{default:u(()=>[g(t(n.author?.name?.charAt(0)||"评"),1)]),_:2},1024)]),e("div",Z,[e("div",ee,[e("span",te,t(n.author?.name||"匿名"),1),e("span",se,t(M+1)+"楼",1)]),e("p",oe,t(n.content),1),e("span",ae,t(k(n.createdAt)),1)])]))),128))])):(a(),x(w,{key:1,description:"还没有人评论，快来抢沙发！","image-size":100})),e("div",ne,[c(I,{modelValue:i.value,"onUpdate:modelValue":d[0]||(d[0]=n=>i.value=n),type:"textarea",rows:3,placeholder:"写下你的看法...",resize:"none"},null,8,["modelValue"]),e("div",ce,[c(L,{type:"primary",onClick:B,loading:v.value},{default:u(()=>[...d[1]||(d[1]=[g(" 发表评论 ",-1)])]),_:1},8,["loading"])])])])])):(a(),x(w,{key:2,description:"帖子不存在或已被删除"}))])}}},de=P(le,[["__scopeId","data-v-6ea390f9"]]);export{de as default};
