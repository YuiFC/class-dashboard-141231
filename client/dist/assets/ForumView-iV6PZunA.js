import{_ as T,r as u,i as j,c as y,e as s,a as t,w as l,b as a,s as b,E as p,d as I,o as c,f as r,h as x,F as P,j as R,t as _}from"./index-vBUVIBNg.js";const q={class:"forum-container"},G={class:"header-actions"},H={style:{"margin-bottom":"20px"}},J={key:1,class:"post-list"},K={class:"post-header"},O={class:"post-title"},Q={class:"post-preview"},W={class:"post-footer"},X={class:"author-info"},Y={class:"author-name"},Z={class:"dialog-footer"},ee={__name:"ForumView",setup(te){const C=I(),f=u([]),v=u(!0),d=u(!1),g=u(!1),n=u({title:"",content:""}),h=async()=>{v.value=!0;try{const i=await b.get("/posts");f.value=i}catch{p.error("加载帖子失败")}finally{v.value=!1}},E=async()=>{if(!n.value.title||!n.value.content){p.warning("标题和内容不能为空");return}g.value=!0;try{await b.post("/posts",n.value),p.success("发布成功！"),d.value=!1,n.value.title="",n.value.content="",h()}catch(i){p.error(i.message||"发布失败")}finally{g.value=!1}},z=i=>{C.push(`/dashboard/forum/${i}`)},B=i=>new Date(i).toLocaleString("zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return j(()=>{h()}),(i,e)=>{const D=a("Edit"),F=a("el-icon"),m=a("el-button"),k=a("el-skeleton-item"),N=a("el-empty"),$=a("el-tag"),U=a("el-avatar"),A=a("el-card"),L=a("el-skeleton"),V=a("el-input"),w=a("el-form-item"),M=a("el-form"),S=a("el-dialog");return c(),y("div",q,[s("div",G,[e[6]||(e[6]=s("h2",null,"班级讨论区",-1)),t(m,{type:"primary",size:"large",onClick:e[0]||(e[0]=o=>d.value=!0)},{default:l(()=>[t(F,{style:{"margin-right":"5px"}},{default:l(()=>[t(D)]),_:1}),e[5]||(e[5]=r(" 发布新帖 ",-1))]),_:1})]),t(L,{loading:v.value,animated:"",count:3},{template:l(()=>[s("div",H,[t(k,{variant:"h3",style:{width:"30%"}}),t(k,{variant:"text",style:{width:"80%"}})])]),default:l(()=>[f.value.length===0?(c(),x(N,{key:0,description:"还没人发言，快来抢沙发！"})):(c(),y("div",J,[(c(!0),y(P,null,R(f.value,o=>(c(),x(A,{key:o._id,class:"post-card",shadow:"hover",onClick:oe=>z(o._id)},{default:l(()=>[s("div",K,[s("span",O,_(o.title),1),t($,{size:"small",effect:"plain"},{default:l(()=>[r(_(B(o.createdAt)),1)]),_:2},1024)]),s("div",Q,_(o.content),1),s("div",W,[s("div",X,[t(U,{size:24,style:{"margin-right":"8px","background-color":"#409eff"}},{default:l(()=>[r(_(o.author?.name?.charAt(0)||"友"),1)]),_:2},1024),s("span",Y,_(o.author?.name||"神秘同学"),1)]),t(m,{type:"primary",link:""},{default:l(()=>[...e[7]||(e[7]=[r("查看详情 >",-1)])]),_:1})])]),_:2},1032,["onClick"]))),128))]))]),_:1},8,["loading"]),t(S,{modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=o=>d.value=o),title:"发布新话题",width:"500px"},{footer:l(()=>[s("span",Z,[t(m,{onClick:e[3]||(e[3]=o=>d.value=!1)},{default:l(()=>[...e[8]||(e[8]=[r("取消",-1)])]),_:1}),t(m,{type:"primary",onClick:E,loading:g.value},{default:l(()=>[...e[9]||(e[9]=[r(" 发布 ",-1)])]),_:1},8,["loading"])])]),default:l(()=>[t(M,{model:n.value,"label-position":"top"},{default:l(()=>[t(w,{label:"标题"},{default:l(()=>[t(V,{modelValue:n.value.title,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value.title=o),placeholder:"请输入标题（必填）"},null,8,["modelValue"])]),_:1}),t(w,{label:"内容"},{default:l(()=>[t(V,{modelValue:n.value.content,"onUpdate:modelValue":e[2]||(e[2]=o=>n.value.content=o),type:"textarea",rows:4,placeholder:"分享你的想法..."},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},ae=T(ee,[["__scopeId","data-v-a3e410c0"]]);export{ae as default};
